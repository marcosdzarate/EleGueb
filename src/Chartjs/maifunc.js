	var	maiColores = [
			'rgba(220,20,60,1)',              //crimson		
			'rgba(100,149,237,1)',              //cornflowerblue		
			'rgba(46,139,87,1)',              //seagreen		
			'rgba(0,0,139,1)',              //darkblue		
			'rgba(138,43,226,1)',               //blueviolet		
			'rgba(165,42,42,1)',                //brown		
			'rgba(255,99,71,1)',              //tomato		
			'rgba(64,224,208,1)',              //turquoise		
			'rgba(238,130,238,1)',              //violet		
			'rgba(245,222,179,1)',              //wheat		
			'rgba(0,255,255,1)',                //aqua		
			'rgba(173,255,47,1)',              //greenyellow		
			'rgba(128,128,128,1)',              //grey		
			'rgba(218,112,214,1)',              //orchid		
			'rgba(0,0,255,1)',                  //blue		
			'rgba(222,184,135,1)',              //burlywood		
			'rgba(255,255,0,1)',              //yellow		
			'rgba(95,158,160,1)',              //cadetblue		
			'rgba(127,255,0,1)',              //chartreuse		
			'rgba(210,105,30,1)',              //chocolate		
			'rgba(255,127,80,1)',              //coral		
			'rgba(0,255,25,1)',              //verde nilo ja ja ja	
			'rgba(0,139,139,1)',              //darkcyan		
			'rgba(255,20,147,1)',              //deeppink		
			'rgba(184,134,11,1)',              //darkgoldenrod		
			'rgba(169,169,169,1)',              //darkgray		
			'rgba(0,100,0,1)',              //darkgreen		
			'rgba(169,169,169,1)',              //darkgrey		
			'rgba(189,183,107,1)',              //darkkhaki		
			'rgba(139,0,139,1)',              //darkmagenta		
			'rgba(85,107,47,1)',              //darkolivegreen		
			'rgba(255,140,0,1)',              //darkorange		
			'rgba(153,50,204,1)',              //darkorchid		
			'rgba(139,0,0,1)',              //darkred		
			'rgba(233,150,122,1)',              //darksalmon		
			'rgba(143,188,143,1)',              //darkseagreen		
			'rgba(72,61,139,1)',              //darkslateblue		
			'rgba(47,79,79,1)',              //darkslategray		
			'rgba(47,79,79,1)',              //darkslategrey		
			'rgba(0,206,209,1)',              //darkturquoise		
			'rgba(148,0,211,1)',              //darkviolet		
			'rgba(0,191,255,1)',              //deepskyblue		
			'rgba(105,105,105,1)',              //dimgray		
			'rgba(105,105,105,1)',              //dimgrey		
			'rgba(30,144,255,1)',              //dodgerblue		
			'rgba(178,34,34,1)',              //firebrick		
			'rgba(255,250,240,1)',              //floralwhite		
			'rgba(34,139,34,1)',              //forestgreen		
			'rgba(255,0,255,1)',              //fuchsia		
			'rgba(220,220,220,1)',              //gainsboro		
			'rgba(248,248,255,1)',              //ghostwhite		
			'rgba(255,215,0,1)',              //gold		
			'rgba(218,165,32,1)',              //goldenrod		
			'rgba(128,128,128,1)',              //gray		
			'rgba(0,128,0,1)',              //green		
			'rgba(240,255,240,1)',              //honeydew		
			'rgba(255,105,180,1)',              //hotpink		
			'rgba(205,92,92,1)',              //indianred		
			'rgba(75,0,130,1)',              //indigo		
			'rgba(255,255,240,1)',              //ivory		
			'rgba(240,230,140,1)',              //khaki		
			'rgba(230,230,250,1)',              //lavender		
			'rgba(255,240,245,1)',              //lavenderblush		
			'rgba(124,252,0,1)',              //lawngreen		
			'rgba(173,216,230,1)',              //lightblue		
			'rgba(255,248,220,1)',              //cornsilk		
			'rgba(240,128,128,1)',              //lightcoral		
			'rgba(224,255,255,1)',              //lightcyan		
			'rgba(250,250,210,1)',              //lightgoldenrodyellow		
			'rgba(211,211,211,1)',              //lightgray		
			'rgba(144,238,144,1)',              //lightgreen		
			'rgba(211,211,211,1)',              //lightgrey		
			'rgba(255,182,193,1)',              //lightpink		
			'rgba(255,160,122,1)',              //lightsalmon		
			'rgba(32,178,170,1)',              //lightseagreen		
			'rgba(135,206,250,1)',              //lightskyblue		
			'rgba(119,136,153,1)',              //lightslategray		
			'rgba(255,99,71,1)',              //tomato		
			'rgba(64,224,208,1)',              //turquoise		
			'rgba(238,130,238,1)',              //violet		
			'rgba(245,222,179,1)',              //wheat		
			'rgba(119,136,153,1)',              //lightslategrey		
			'rgba(176,196,222,1)',              //lightsteelblue		
			'rgba(245,245,220,1)',              //beige		
			'rgba(255,255,224,1)',              //lightyellow		
			'rgba(0,255,0,1)',              //lime		
			'rgba(50,205,50,1)',              //limegreen		
			'rgba(250,240,230,1)',              //linen		
			'rgba(255,0,255,1)',              //magenta		
			'rgba(128,0,0,1)',              //maroon		
			'rgba(102,205,170,1)',              //mediumaquamarine		
			'rgba(0,0,205,1)',              //mediumblue		
			'rgba(186,85,211,1)',              //mediumorchid		
			'rgba(147,112,219,1)',              //mediumpurple		
			'rgba(60,179,113,1)',              //mediumseagreen		
			'rgba(123,104,238,1)',              //mediumslateblue		
			'rgba(0,250,154,1)',              //mediumspringgreen		
			'rgba(72,209,204,1)',              //mediumturquoise		
			'rgba(199,21,133,1)',              //mediumvioletred		
			'rgba(25,25,112,1)',              //midnightblue		
			'rgba(245,255,250,1)',              //mintcream		
			'rgba(255,228,225,1)',              //mistyrose		
			'rgba(255,228,181,1)',              //moccasin		
			'rgba(255,222,173,1)',              //navajowhite		
			'rgba(0,0,128,1)',              //navy		
			'rgba(253,245,230,1)',              //oldlace		
			'rgba(128,128,0,1)',              //olive		
			'rgba(107,142,35,1)',              //olivedrab		
			'rgba(255,165,0,1)',              //orange		
			'rgba(255,69,0,1)',              //orangered		
			'rgba(238,232,170,1)',              //palegoldenrod		
			'rgba(152,251,152,1)',              //palegreen		
			'rgba(175,238,238,1)',              //paleturquoise		
			'rgba(219,112,147,1)',              //palevioletred		
			'rgba(255,239,213,1)',              //papayawhip		
			'rgba(255,218,185,1)',              //peachpuff		
			'rgba(205,133,63,1)',              //peru		
			'rgba(255,192,203,1)',              //pink		
			'rgba(221,160,221,1)',              //plum		
			'rgba(176,224,230,1)',              //powderblue		
			'rgba(128,0,128,1)',              //purple		
			'rgba(102, 51, 153,1)',              //rebeccapurple		
			'rgba(255,0,0,1)',              //red		
			'rgba(188,143,143,1)',              //rosybrown		
			'rgba(65,105,225,1)',              //royalblue		
			'rgba(139,69,19,1)',              //saddlebrown		
			'rgba(250,128,114,1)',              //salmon		
			'rgba(244,164,96,1)',              //sandybrown		
			'rgba(255,245,238,1)',              //seashell		
			'rgba(160,82,45,1)',              //sienna		
			'rgba(192,192,192,1)',              //silver		
			'rgba(135,206,235,1)',              //skyblue		
			'rgba(255,228,196,1)',              //bisque		
			'rgba(0,0,0,1)',                    //black		
			'rgba(106,90,205,1)',              //slateblue		
			'rgba(112,128,144,1)',              //slategray		
			'rgba(112,128,144,1)',              //slategrey		
			'rgba(240,248,255,1)',              //aliceblue		
			'rgba(250,235,215,1)',              //antiquewhite		
			'rgba(255,250,250,1)',              //snow		
			'rgba(127,255,212,1)',              //aquamarine		
			'rgba(255,235,205,1)',              //blanchedalmond		
			'rgba(240,255,255,1)',              //azure		
			'rgba(0,255,127,1)',              //springgreen		
			'rgba(70,130,180,1)',              //steelblue		
			'rgba(210,180,140,1)',              //tan		
			'rgba(0,128,128,1)',              //teal		
			'rgba(216,191,216,1)',              //thistle		
			'rgba(255,255,255,1)',              //white		
			'rgba(245,245,245,1)',              //whitesmoke		
			'rgba(154,205,50],1)'              //yellowgreen		
		];

			/* devuelve el string fecha "fst" como una fecha mas "s" dias */
			function cfecha(fst,s){
				var d = new Date(fst);
				d.setDate(d.getDate() + s);
				return d;
			}	



			

			/* function  donde....
			/* dónde está o estaría pCate en Manda												*/
			/* Manda es el arreglo que contiene (en principio) un elemento por cada				*/
			/*		label/categoria que se grafica; 											*/
			/* 		-el valor del elemento es es valor del checkbox asociado al label/catogoria	*/
			/* 		 que a su vez indica el orden de la categoria en el gráfico;				*/
			/*		-se modifica cuando se elimina o repone una categoria del grafico			*/
			function donde(pCate){
					function checkpCate(cat) {
						return cat >= Number(pCate);
					}
				return Manda.findIndex(checkpCate);
			}


			/* elimina label/categoria del gráfico 												*/
			/* el arreglo Manda se actualiza eliminando el elemento de valor cboxCate			*/
			function sacaDato(cboxCate)  {
				p = donde(cboxCate);
				Manda.splice(p,1)
						//alert(p+"--"+Manda);
				DatosChart.labels.splice(p, 1); 
				DatosChart.datasets.forEach(function(dataset) {
					dataset.data.splice(p,1);
				});
				myChart.update();
			};

			

			/* repone label/categoria en el grafico en la posicion original					*/
			/* cboxCate es el valor del checkbox original de la label/categoria				*/
			/* el arreglo Manda se actualiza reponiendo el elemento "indi" en su lugar		*/
			function poneDato(cboxCate) {
				p = donde(cboxCate);
				if (p==-1) {
					//ultimo elemento 
					Manda.push(cboxCate);
					DatosChart.labels.push(clabelX[cboxCate]); 
					ds=0;
					DatosChart.datasets.forEach(function(dataset) {
						dataset.backgroundColor = maiColores[ds];
						dataset.borderColor = maiColores[ds];
						ds += 1;
						dataset.data.push(eval("cDS"+ds)[cboxCate]);
				
						});
					}
				else
				{
					Manda.splice(p,0,cboxCate);
					DatosChart.labels.splice(p, 0,clabelX[cboxCate]); 
					ds=0;
					DatosChart.datasets.forEach(function(dataset) {
						dataset.backgroundColor = maiColores[ds];
						dataset.borderColor = maiColores[ds];
						ds += 1;
						dataset.data.splice(p,0,eval("cDS"+ds)[cboxCate]);				
						});
				}
				myChart.update();
            };			
			

			
			/* debajo del gráfico hay un checkbox por cada categoría (name=cat..) graficada		*/
			/* 		value es el orden de la label/categoria 									*/
			/* 		no-checked elimina label y datos											*/
			/* 		checked repone label y datos en el orden original							*/
			/* cbox es el checkbox 																*/
			function SacaPone(cbox) {
			   if (cbox.checked==true){
					poneDato(cbox.value)
			       }
				   else {
				   sacaDato(cbox.value)
				  }
			  }
			  
			  
			/* elimina todos los label/categoria del gráfico 		(no se usa)	*/
			function sacaTodo()  {
				Manda=[];
				DatosChart.labels=[];
				DatosChart.datasets.forEach(function(dataset) {
					dataset.data = [];
				});
				myChart.update();
				// des-checked todas las checkbox de categorias (la clase es chbx)
				var x = document.getElementsByClassName("chbx");
				var i;
				for (i = 0; i < x.length; i++) {
					x[i].checked = false;
				} 				
			};


			/* oculta/repone todos los datasets del grafico "mCh"*/
			function DSponeSacaTodos(mCh,bot){
				var botv = bot.innerHTML;
				let ci = mCh.chart;	
                if (botv=="ocultar todos los DS"){
					bot.innerHTML="mostrar todos los DS";
					for (i = 0; i < ci.data.datasets.length; i++) {
					   var meta = ci.getDatasetMeta(i);
					   meta.hidden = true;
					}
				}
				else{
					bot.innerHTML="ocultar todos los DS";
					for (i = 0; i < ci.data.datasets.length; i++) {
					   var meta = ci.getDatasetMeta(i);
					   meta.hidden =  null;
					}
				}

				ci.update();			
			}
			
			

			/* invierte seleccion de DS */
			function DSInvierteSeleccion(mCh){
				let ci = mCh.chart;
				
				for (i = 0; i < ci.data.datasets.length; i++) {
				   var meta = ci.getDatasetMeta(i);
				   meta.hidden = meta.hidden === null? !ci.data.datasets[i].hidden : null;
				}
				ci.update();			
			}

			
			/* oculta/repone todos los label/categoria del gráfico "mCh"  */
			/* "vCh" es la variable que tiene los datos del grafico */
			/* Manda es el arreglo definido para manegajar las categorias*/
			/* bot el boton que pide la accion*/
			function CXponeSaca(mCh,vCh,bot)  {
				var botv = bot.innerHTML;
				var x = document.getElementsByClassName("chbx");  // todas las checkbox de categorias (la clase es chbx)
				var i;
				if (botv=="ocultar todas las categorías"){
					bot.innerHTML="mostrar todas las categor&iacute;s";				
					Manda=[];
					vCh.labels=[];
					vCh.datasets.forEach(function(dataset) {
						dataset.data = [];
						});
					// unchecked todas las checkbox de categorias (la clase es chbx)
					for (i = 0; i < x.length; i++) {
						x[i].checked = false;
					} 
				}
				else {
					bot.innerHTML="ocultar todas las categor&iacute;as";				
					for (i = 0; i < x.length; i++) {
						if (x[i].checked==false) {
							x[i].checked = true;
							poneDato(x[i].value);
					   }
					}
				}
				myChart.update();
				
			};
			
			

  function limiteY(maxi){
	  /* cambia maximo eje Y */
	  myChart.options.scales.yAxes[0].ticks.max=Number(maxi);
	  myChart.update();
  }
  function limiteYauto(){
	  /* cambia limites a auto eje Y */
	  delete myChart.options.scales.yAxes[0].ticks.max;
	  myChart.update();
  }
  
  function limiteXmin(mini){
	  /* cambia minimo eje X */
	  myChart.options.scales.xAxes[0].ticks.min=Number(mini);
	  myChart.update();
  }
  function limiteXmax(maxi){
	  /* cambia maximo eje X */
	  myChart.options.scales.xAxes[0].ticks.max=Number(maxi);
	  myChart.update();
  }
  function limiteXauto(lmin){
	  /* cambia limites a auto eje X */
	  delete myChart.options.scales.xAxes[0].ticks.max;
	  myChart.options.scales.xAxes[0].ticks.min=lmin;
	  myChart.update();
  }  
			
